package com.hommy.service;

import com.hommy.service.interfaces.ITopic;

public class ProcessPublicationQueue implements Runnable {
	private boolean running = true;

	public void stop() {
		running = false;
	}

	@Override
	public void run() {

		while (running) {
			Publication publication = PublicationQueue.pollPublication();
			if (publication != null) {
				System.out.println("Procesing: " + publication.getMessage());

				ITopic topic = TopicsPool.getTopic(publication.getTopicName());
				topic.publishMessage(publication.getMessage());
			} else {
				System.out.println("Publication queue is empty, hence stoping.");
				running = false;
			}
		}

	}
}
