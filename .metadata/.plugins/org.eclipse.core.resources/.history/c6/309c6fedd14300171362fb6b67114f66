package com.hommy.service;

import com.hommy.service.interfaces.ITopic;

public class ProcessPublicationQueue implements Runnable {
	private boolean isRunning = true;

	public void stop() {
		isRunning = false;
	}

	@Override
	public void run() {

		while (isRunning) {
			Publication publication = PublicationQueue.pollPublication();
			if (publication != null) {
				System.out.println("Procesing: " + publication.getMessage());

				ITopic topic = TopicsPool.getTopic(publication.getTopicName());
				topic.publishMessage(publication.getMessage());
			} else {
				System.out.println("Publication queue is empty, hence stoping.");
				isRunning = false;
			}
		}

	}
}
