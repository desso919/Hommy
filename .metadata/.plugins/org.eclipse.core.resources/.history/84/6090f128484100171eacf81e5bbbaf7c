package com.hommy.administrator.dao.impl;

import java.sql.Connection;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.SQLException;

import com.hommy.administrator.dao.interfaces.IEvent;
import com.hommy.administrator.dao.objects.Event;
import com.hommy.administrator.dao.objects.Events;
import com.hommy.database.DatabaseConnection;

public class EventsOperation implements IEvent {

	static {
		DatabaseConnection.initialize();
	}

	@Override
	public Events getAllEvents() {
		Connection connection = DatabaseConnection.createConnection();
		Events events = new Events();

		String query = "select * from events";

		PreparedStatement preparedStatement;
		try {
			preparedStatement = connection.prepareStatement(query);
			ResultSet resultSet = preparedStatement.executeQuery();

			while (resultSet.next()) {
				int id = resultSet.getInt("Id");
				String eventName = resultSet.getString("eventname");
				String description = resultSet.getString("description");

				System.out.println("Event: " + id + "  " + eventName + "   " + description);

				events.addEvent(new Event(id, eventName, description));
			}
		} catch (SQLException e) {
			e.printStackTrace();
		}

		return events;
	}

	@Override
	public Event getEvent(Event event) {
		Connection connection = DatabaseConnection.createConnection();

		String query = "select * from events where eventname=?";

		PreparedStatement preparedStatement;
		try {
			preparedStatement = connection.prepareStatement(query);
			preparedStatement.setString(1, event.getName());

			ResultSet resultSet = preparedStatement.executeQuery();

			if (resultSet.next()) {
				int id = resultSet.getInt("Id");
				String eventName = resultSet.getString("eventname");
				String description = resultSet.getString("description");

				System.out.println("Event: " + id + "  " + eventName + "   " + description);

				return new Event(id, eventName, description);
			}
		} catch (SQLException e) {
			e.printStackTrace();
		}

		return null;
	}

	@Override
	public void addEvent(Event event) {
		// TODO Auto-generated method stub

	}

	@Override
	public boolean removeEvent(Event event) {
		Connection connection = DatabaseConnection.createConnection();

		String query = "delete from events where id=?";

		PreparedStatement preparedStatement;
		try {
			preparedStatement = connection.prepareStatement(query);
			preparedStatement.setInt(1, event.getId());

			int result = preparedStatement.executeUpdate();

			return result;
		} catch (SQLException e) {
			e.printStackTrace();
		}

	}

}
